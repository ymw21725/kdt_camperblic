{"ast":null,"code":"import _slicedToArray from\"/Users/ethan/Documents/codream_final/camperblic/src/main/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import axios from'axios';import Barchart from'./Barchart';import{jsx as _jsx}from\"react/jsx-runtime\";var AdminDashboardGraph=function AdminDashboardGraph(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),graphData=_useState2[0],setGraphData=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),graphDTO=_useState4[0],setGraphDTO=_useState4[1];useEffect(function(){axios.get('/admindashboard/admindashboardchart').then(function(response){var data=response.data;// 데이터 형식 변환\nvar formattedData=data.map(function(_ref){var _ref2=_slicedToArray(_ref,2),date=_ref2[0],value=_ref2[1];return{date:date,value:value};});setGraphData(formattedData);// 날짜별 매출액 계산\nvar currentDate=new Date().toISOString().slice(0,10);var filteredData={fourTotalPrice:0,threeTotalPrice:0,twoTotalPrice:0,oneTotalPrice:0,currTotalPrice:0,totalPriceSum:0};formattedData.forEach(function(_ref3){var date=_ref3.date,value=_ref3.value;var daysAgo=Math.floor((new Date(currentDate).getTime()-new Date(date).getTime())/(24*60*60*1000));if(daysAgo===4){filteredData.fourTotalPrice+=value;}else if(daysAgo===3){filteredData.threeTotalPrice+=value;}else if(daysAgo===2){filteredData.twoTotalPrice+=value;}else if(daysAgo===1){filteredData.oneTotalPrice+=value;}else if(daysAgo===0){filteredData.currTotalPrice+=value;}});// 현재월 총합 계산\nfilteredData.totalPriceSum=formattedData.reduce(function(sum,_ref4){var value=_ref4.value;return sum+value;},0);setGraphDTO(filteredData);}).catch(function(error){console.log(error);});},[]);return/*#__PURE__*/_jsx(\"section\",{children:graphDTO?/*#__PURE__*/_jsx(Barchart,{graphDTO:graphDTO}):/*#__PURE__*/_jsx(\"p\",{children:\"Loading graph data...\"})});};export default AdminDashboardGraph;","map":{"version":3,"names":["React","useEffect","useState","axios","Barchart","jsx","_jsx","AdminDashboardGraph","_useState","_useState2","_slicedToArray","graphData","setGraphData","_useState3","_useState4","graphDTO","setGraphDTO","get","then","response","data","formattedData","map","_ref","_ref2","date","value","currentDate","Date","toISOString","slice","filteredData","fourTotalPrice","threeTotalPrice","twoTotalPrice","oneTotalPrice","currTotalPrice","totalPriceSum","forEach","_ref3","daysAgo","Math","floor","getTime","reduce","sum","_ref4","catch","error","console","log","children"],"sources":["/Users/ethan/Documents/codream_final/camperblic/src/main/frontend/src/pages/admin/components/admindashboard/AdminDashboardGraph.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Barchart from './Barchart';\nimport { GraphDTO } from '../../../../types';\n\ninterface GraphDataItem {\n    date: string;\n    value: number;\n}\n\nconst AdminDashboardGraph = () => {\n    const [graphData, setGraphData] = useState<GraphDataItem[]>([]);\n    const [graphDTO, setGraphDTO] = useState<GraphDTO | null>(null);\n\n    useEffect(() => {\n        axios\n            .get('/admindashboard/admindashboardchart')\n            .then((response) => {\n                const data: [string, number][] = response.data;\n\n                // 데이터 형식 변환\n                const formattedData: GraphDataItem[] = data.map(([date, value]) => ({\n                    date,\n                    value,\n                }));\n\n                setGraphData(formattedData);\n\n                // 날짜별 매출액 계산\n                const currentDate = new Date().toISOString().slice(0, 10);\n                const filteredData: GraphDTO = {\n                    fourTotalPrice: 0,\n                    threeTotalPrice: 0,\n                    twoTotalPrice: 0,\n                    oneTotalPrice: 0,\n                    currTotalPrice: 0,\n                    totalPriceSum: 0,\n                };\n\n                formattedData.forEach(({ date, value }) => {\n                    const daysAgo = Math.floor(\n                        (new Date(currentDate).getTime() - new Date(date).getTime()) /\n                        (24 * 60 * 60 * 1000)\n                    );\n                    if (daysAgo === 4) {\n                        filteredData.fourTotalPrice += value;\n                    } else if (daysAgo === 3) {\n                        filteredData.threeTotalPrice += value;\n                    } else if (daysAgo === 2) {\n                        filteredData.twoTotalPrice += value;\n                    } else if (daysAgo === 1) {\n                        filteredData.oneTotalPrice += value;\n                    } else if (daysAgo === 0) {\n                        filteredData.currTotalPrice += value;\n                    }\n                });\n\n                // 현재월 총합 계산\n                filteredData.totalPriceSum = formattedData.reduce(\n                    (sum, { value }) => sum + value,\n                    0\n                );\n\n                setGraphDTO(filteredData);\n            })\n            .catch((error) => {\n                console.log(error);\n            });\n    }, []);\n\n    return (\n        <section>\n            {graphDTO ? (\n                <Barchart graphDTO={graphDTO} />\n            ) : (\n                <p>Loading graph data...</p>\n            )}\n        </section>\n    );\n};\n\nexport default AdminDashboardGraph;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}